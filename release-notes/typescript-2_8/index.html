<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
    <link rel="stylesheet" href="/typescript/umi.8c6752e0.css" />
    <script>
      window.routerBase = "/typescript/";
    </script>
    <script>
      //! umi version: 3.5.20
    </script>
    <script>
      !(function () {
        var e = localStorage.getItem("dumi:prefers-color"),
          t = window.matchMedia("(prefers-color-scheme: dark)").matches,
          r = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === r[2] ? (t ? r[1] : r[0]) : r.indexOf(e) > -1 ? e : r[0]
        );
      })();
    </script>
    <title>TypeScript 2.8 - TypeScript手册</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/release-notes/typescript-2_8" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/javascript-guidebook-favicon.png&#x27;)" href="/typescript//">TypeScript手册</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span><a href="/typescript//tutorials">介绍</a></span><span><a href="/typescript//handbook">基础</a></span><span><a href="/typescript//reference">进阶</a></span><span><a href="/typescript//handbook-v2">字面量类型</a></span><span><a href="/typescript//declaration-files">声明文件</a></span><span><a href="/typescript//javascript">类型检查-JS</a></span><span><a href="/typescript//project-config">工程配置</a></span><span><a href="/typescript//wiki">Wiki</a></span><span><a aria-current="page" class="active" href="/typescript//release-notes">新增</a></span><span><a href="/typescript//breaking-changes">改动</a></span><span><a target="_blank" rel="noopener noreferrer" href="https://github.com/onlyxhb/typescript">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span><div class="__dumi-default-navbar-tool"><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "></div></div></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/javascript-guidebook-favicon.png&#x27;)" href="/typescript//"></a><h1>TypeScript手册</h1><p>JavaScript 完全知识体系</p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="/typescript//tutorials">介绍</a></li><li><a href="/typescript//handbook">基础</a></li><li><a href="/typescript//reference">进阶</a></li><li><a href="/typescript//handbook-v2">字面量类型</a></li><li><a href="/typescript//declaration-files">声明文件</a></li><li><a href="/typescript//javascript">类型检查-JS</a></li><li><a href="/typescript//project-config">工程配置</a></li><li><a href="/typescript//wiki">Wiki</a></li><li><a aria-current="page" class="active" href="/typescript//release-notes">新增</a></li><li><a href="/typescript//breaking-changes">改动</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/onlyxhb/typescript">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "><button title="Dark theme" class="__dumi-default-dark-moon "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="22" height="22"><path d="M991.816611 674.909091a69.166545 69.166545 0 0 0-51.665455-23.272727 70.795636 70.795636 0 0 0-27.438545 5.585454A415.674182 415.674182 0 0 1 754.993338 698.181818c-209.594182 0-393.472-184.785455-393.472-395.636363 0-52.363636 38.539636-119.621818 69.515637-173.614546 4.887273-8.610909 9.634909-16.756364 14.103272-24.901818A69.818182 69.818182 0 0 0 384.631156 0a70.842182 70.842182 0 0 0-27.438545 5.585455C161.678429 90.298182 14.362065 307.898182 14.362065 512c0 282.298182 238.824727 512 532.38691 512a522.286545 522.286545 0 0 0 453.957818-268.334545A69.818182 69.818182 0 0 0 991.816611 674.909091zM546.679156 954.181818c-248.785455 0-462.941091-192-462.941091-442.181818 0-186.647273 140.637091-372.829091 300.939637-442.181818-36.817455 65.629091-92.578909 151.970909-92.578909 232.727273 0 250.181818 214.109091 465.454545 462.917818 465.454545a488.331636 488.331636 0 0 0 185.181091-46.545455 453.003636 453.003636 0 0 1-393.565091 232.727273z m103.656728-669.323636l-14.266182 83.781818a34.909091 34.909091 0 0 0 50.362182 36.770909l74.775272-39.563636 74.752 39.563636a36.142545 36.142545 0 0 0 16.174546 3.956364 34.909091 34.909091 0 0 0 34.210909-40.727273l-14.289455-83.781818 60.509091-59.345455a35.025455 35.025455 0 0 0-19.223272-59.578182l-83.61891-12.101818-37.376-76.101818a34.56 34.56 0 0 0-62.254545 0l-37.376 76.101818-83.618909 12.101818a34.909091 34.909091 0 0 0-19.246546 59.578182z m70.423272-64.698182a34.280727 34.280727 0 0 0 26.135273-19.083636l14.312727-29.090909 14.336 29.090909a34.257455 34.257455 0 0 0 26.135273 19.083636l32.046546 4.887273-23.272728 22.574545a35.234909 35.234909 0 0 0-10.007272 30.952727l5.46909 32.116364-28.625454-15.127273a34.490182 34.490182 0 0 0-32.302546 0l-28.695272 15.127273 5.469091-32.116364a35.141818 35.141818 0 0 0-9.984-30.952727l-23.272728-22.574545z" p-id="3855"></path></svg></button><button title="Light theme" class="__dumi-default-dark-sun "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4026" width="22" height="22"><path d="M915.2 476.16h-43.968c-24.704 0-44.736 16-44.736 35.84s20.032 35.904 44.736 35.904H915.2c24.768 0 44.8-16.064 44.8-35.904s-20.032-35.84-44.8-35.84zM512 265.6c-136.704 0-246.464 109.824-246.464 246.4 0 136.704 109.76 246.464 246.464 246.464S758.4 648.704 758.4 512c0-136.576-109.696-246.4-246.4-246.4z m0 425.6c-99.008 0-179.2-80.128-179.2-179.2 0-98.944 80.192-179.2 179.2-179.2S691.2 413.056 691.2 512c0 99.072-80.192 179.2-179.2 179.2zM197.44 512c0-19.84-19.136-35.84-43.904-35.84H108.8c-24.768 0-44.8 16-44.8 35.84s20.032 35.904 44.8 35.904h44.736c24.768 0 43.904-16.064 43.904-35.904zM512 198.464c19.776 0 35.84-20.032 35.84-44.8v-44.8C547.84 84.032 531.84 64 512 64s-35.904 20.032-35.904 44.8v44.8c0 24.768 16.128 44.864 35.904 44.864z m0 627.136c-19.776 0-35.904 20.032-35.904 44.8v44.736C476.096 940.032 492.16 960 512 960s35.84-20.032 35.84-44.8v-44.736c0-24.768-16.064-44.864-35.84-44.864z m329.92-592.832c17.472-17.536 20.288-43.072 6.4-57.024-14.016-14.016-39.488-11.2-57.024 6.336-4.736 4.864-26.496 26.496-31.36 31.36-17.472 17.472-20.288 43.008-6.336 57.024 13.952 14.016 39.488 11.2 57.024-6.336 4.8-4.864 26.496-26.56 31.296-31.36zM213.376 759.936c-4.864 4.8-26.56 26.624-31.36 31.36-17.472 17.472-20.288 42.944-6.4 56.96 14.016 13.952 39.552 11.2 57.024-6.336 4.8-4.736 26.56-26.496 31.36-31.36 17.472-17.472 20.288-43.008 6.336-56.96-14.016-13.952-39.552-11.072-56.96 6.336z m19.328-577.92c-17.536-17.536-43.008-20.352-57.024-6.336-14.08 14.016-11.136 39.488 6.336 57.024 4.864 4.864 26.496 26.56 31.36 31.424 17.536 17.408 43.008 20.288 56.96 6.336 14.016-14.016 11.264-39.488-6.336-57.024-4.736-4.864-26.496-26.56-31.296-31.424z m527.168 628.608c4.864 4.864 26.624 26.624 31.36 31.424 17.536 17.408 43.072 20.224 57.088 6.336 13.952-14.016 11.072-39.552-6.4-57.024-4.864-4.8-26.56-26.496-31.36-31.36-17.472-17.408-43.072-20.288-57.024-6.336-13.952 14.016-11.008 39.488 6.336 56.96z" p-id="4027"></path></svg></button><button title="Default to system" class="__dumi-default-dark-auto "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11002" width="22" height="22"><path d="M127.658667 492.885333c0-51.882667 10.24-101.717333 30.378666-149.162666s47.786667-88.064 81.92-122.538667 75.093333-61.781333 122.538667-81.92 96.938667-30.378667 149.162667-30.378667 101.717333 10.24 149.162666 30.378667 88.405333 47.786667 122.88 81.92 61.781333 75.093333 81.92 122.538667 30.378667 96.938667 30.378667 149.162666-10.24 101.717333-30.378667 149.162667-47.786667 88.405333-81.92 122.88-75.093333 61.781333-122.88 81.92-97.28 30.378667-149.162666 30.378667-101.717333-10.24-149.162667-30.378667-88.064-47.786667-122.538667-81.92-61.781333-75.093333-81.92-122.88-30.378667-96.938667-30.378666-149.162667z m329.045333 0c0 130.048 13.994667 244.394667 41.984 343.381334h12.970667c46.762667 0 91.136-9.216 133.461333-27.306667s78.848-42.666667 109.568-73.386667 54.954667-67.242667 73.386667-109.568 27.306667-86.698667 27.306666-133.461333c0-46.421333-9.216-90.794667-27.306666-133.12s-42.666667-78.848-73.386667-109.568-67.242667-54.954667-109.568-73.386667-86.698667-27.306667-133.461333-27.306666h-11.605334c-28.672 123.562667-43.349333 237.909333-43.349333 343.722666z" p-id="11003"></path></svg></button></div></div></div><ul class="__dumi-default-menu-list"><li><a href="/typescript//release-notes">新增</a></li><li><a href="/typescript//release-notes/typescript-1_1">TypeScript 1.1</a></li><li><a href="/typescript//release-notes/typescript-1_3">TypeScript 1.3</a></li><li><a href="/typescript//release-notes/typescript-1_4">TypeScript 1.4</a></li><li><a href="/typescript//release-notes/typescript-1_5">TypeScript 1.5</a></li><li><a href="/typescript//release-notes/typescript-1_6">TypeScript 1.6</a></li><li><a href="/typescript//release-notes/typescript-1_7">TypeScript 1.7</a></li><li><a href="/typescript//release-notes/typescript-1_8">TypeScript 1.8</a></li><li><a href="/typescript//release-notes/typescript-2_0">TypeScript 2.0</a></li><li><a href="/typescript//release-notes/typescript-2_1">TypeScript 2.1</a></li><li><a href="/typescript//release-notes/typescript-2_2">TypeScript 2.2</a></li><li><a href="/typescript//release-notes/typescript-2_3">TypeScript 2.3</a></li><li><a href="/typescript//release-notes/typescript-2_4">TypeScript 2.4</a></li><li><a href="/typescript//release-notes/typescript-2_5">TypeScript 2.5</a></li><li><a href="/typescript//release-notes/typescript-2_6">TypeScript 2.6</a></li><li><a href="/typescript//release-notes/typescript-2_7">TypeScript 2.7</a></li><li><a aria-current="page" class="active" href="/typescript//release-notes/typescript-2_8">TypeScript 2.8</a></li><li><a href="/typescript//release-notes/typescript-2_9">TypeScript 2.9</a></li><li><a href="/typescript//release-notes/typescript-3_0">TypeScript 3.0</a></li><li><a href="/typescript//release-notes/typescript-3_1">TypeScript 3.1</a></li><li><a href="/typescript//release-notes/typescript-3_2">TypeScript 3.2</a></li><li><a href="/typescript//release-notes/typescript-3_3">TypeScript 3.3</a></li><li><a href="/typescript//release-notes/typescript-3_4">TypeScript 3.4</a></li><li><a href="/typescript//release-notes/typescript-3_5">TypeScript 3.5</a></li><li><a href="/typescript//release-notes/typescript-3_6">TypeScript 3.6</a></li><li><a href="/typescript//release-notes/typescript-3_7">TypeScript 3.7</a></li><li><a href="/typescript//release-notes/typescript-3_8">TypeScript 3.8</a></li><li><a href="/typescript//release-notes/typescript-3_9">TypeScript 3.9</a></li><li><a href="/typescript//release-notes/typescript-4_0">TypeScript 4.0</a></li><li><a href="/typescript//release-notes/typescript-4_1">TypeScript 4.1</a></li><li><a href="/typescript//release-notes/typescript-4_2">TypeScript 4.2</a></li><li><a href="/typescript//release-notes/typescript-4_3">TypeScript 4.3</a></li><li><a href="/typescript//release-notes/typescript-4_4">TypeScript 4.4</a></li><li><a href="/typescript//release-notes/typescript-4_5">TypeScript 4.5</a></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="有条件类型" data-depth="2"><a href="/typescript//release-notes/typescript-2_8#有条件类型"><span>有条件类型</span></a></li><li title="分布式有条件类型" data-depth="3"><a href="/typescript//release-notes/typescript-2_8#分布式有条件类型"><span>分布式有条件类型</span></a></li><li title="有条件类型中的类型推断" data-depth="3"><a href="/typescript//release-notes/typescript-2_8#有条件类型中的类型推断"><span>有条件类型中的类型推断</span></a></li><li title="预定义的有条件类型" data-depth="3"><a href="/typescript//release-notes/typescript-2_8#预定义的有条件类型"><span>预定义的有条件类型</span></a></li><li title="改进对映射类型修饰符的控制" data-depth="2"><a href="/typescript//release-notes/typescript-2_8#改进对映射类型修饰符的控制"><span>改进对映射类型修饰符的控制</span></a></li><li title="改进交叉类型上的keyof" data-depth="2"><a href="/typescript//release-notes/typescript-2_8#改进交叉类型上的keyof"><span>改进交叉类型上的keyof</span></a></li><li title="更好的处理.js文件中的命名空间模式" data-depth="2"><a href="/typescript//release-notes/typescript-2_8#更好的处理js文件中的命名空间模式"><span>更好的处理.js文件中的命名空间模式</span></a></li><li title="立即执行的函数表达式做为命名空间" data-depth="3"><a href="/typescript//release-notes/typescript-2_8#立即执行的函数表达式做为命名空间"><span>立即执行的函数表达式做为命名空间</span></a></li><li title="默认声明" data-depth="3"><a href="/typescript//release-notes/typescript-2_8#默认声明"><span>默认声明</span></a></li><li title="原型赋值" data-depth="3"><a href="/typescript//release-notes/typescript-2_8#原型赋值"><span>原型赋值</span></a></li><li title="嵌套与合并声明" data-depth="3"><a href="/typescript//release-notes/typescript-2_8#嵌套与合并声明"><span>嵌套与合并声明</span></a></li><li title="各文件的JSX工厂" data-depth="2"><a href="/typescript//release-notes/typescript-2_8#各文件的jsx工厂"><span>各文件的JSX工厂</span></a></li><li title="本地范围的JSX命名空间" data-depth="2"><a href="/typescript//release-notes/typescript-2_8#本地范围的jsx命名空间"><span>本地范围的JSX命名空间</span></a></li><li title="新的--emitDeclarationsOnly" data-depth="2"><a href="/typescript//release-notes/typescript-2_8#新的--emitdeclarationsonly"><span>新的--emitDeclarationsOnly</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="typescript-28"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#typescript-28"><span class="icon icon-link"></span></a>TypeScript 2.8</h1><h2 id="有条件类型"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#有条件类型"><span class="icon icon-link"></span></a>有条件类型</h2><p>TypeScript 2.8引入了_有条件类型_，它能够表示非统一的类型。 有条件的类型会以一个条件表达式进行类型关系检测，从而在两种类型中选择其一：</p><div class="__dumi-default-code-block"><pre class="prism-code language-typescript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token constant">T</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name constant">U</span><span class="token plain"> </span><span class="token operator">?</span><span class="token plain"> </span><span class="token constant">X</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"> </span><span class="token constant">Y</span></div></pre></div><p>上面的类型意思是，若<code>T</code>能够赋值给<code>U</code>，那么类型是<code>X</code>，否则为<code>Y</code>。</p><p>有条件的类型<code>T extends U ? X : Y</code>或者_解析_为<code>X</code>，或者_解析_为<code>Y</code>，再或者_延迟_解析，因为它可能依赖一个或多个类型变量。 是否直接解析或推迟取决于：</p><ul><li>首先，令<code>T&#x27;</code>和<code>U&#x27;</code>分别为<code>T</code>和<code>U</code>的实例，并将所有类型参数替换为<code>any</code>，如果<code>T&#x27;</code>不能赋值给<code>U&#x27;</code>，则将有条件的类型解析成<code>Y</code>。直观上讲，如果最宽泛的<code>T</code>的实例不能赋值给最宽泛的<code>U</code>的实例，那么我们就可以断定不存在可以赋值的实例，因此可以解析为<code>Y</code>。</li><li>其次，针对每个在<code>U</code>内由<code>推断</code>声明引入的类型变量，依据从<code>T</code>推断到<code>U</code>来收集一组候选类型（使用与泛型函数类型推断相同的推断算法）。对于给定的<code>推断</code>类型变量<code>V</code>，如果有候选类型是从协变的位置上推断出来的，那么<code>V</code>的类型是那些候选类型的联合。反之，如果有候选类型是从逆变的位置上推断出来的，那么<code>V</code>的类型是那些候选类型的交叉类型。否则<code>V</code>的类型是<code>never</code>。</li><li>然后，令<code>T&#x27;&#x27;</code>为<code>T</code>的一个实例，所有<code>推断</code>的类型变量用上一步的推断结果替换，如果<code>T&#x27;&#x27;</code>_明显可赋值_给<code>U</code>，那么将有条件的类型解析为<code>X</code>。除去不考虑类型变量的限制之外，_明显可赋值_的关系与正常的赋值关系一致。直观上，当一个类型明显可赋值给另一个类型，我们就能够知道它可以赋值给那些类型的_所有_实例。</li><li>否则，这个条件依赖于一个或多个类型变量，有条件的类型解析被推迟进行。</li></ul><h4 id="例子"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#例子"><span class="icon icon-link"></span></a>例子</h4><div class="__dumi-default-code-block"><pre class="prism-code language-typescript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">TypeName</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token constant">T</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name builtin">string</span><span class="token plain"> </span><span class="token operator">?</span><span class="token plain"> </span><span class="token string">&quot;string&quot;</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token constant">T</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name builtin">number</span><span class="token plain"> </span><span class="token operator">?</span><span class="token plain"> </span><span class="token string">&quot;number&quot;</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token constant">T</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name builtin">boolean</span><span class="token plain"> </span><span class="token operator">?</span><span class="token plain"> </span><span class="token string">&quot;boolean&quot;</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token constant">T</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name keyword nil">undefined</span><span class="token plain"> </span><span class="token operator">?</span><span class="token plain"> </span><span class="token string">&quot;undefined&quot;</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token constant">T</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name known-class-name class-name">Function</span><span class="token plain"> </span><span class="token operator">?</span><span class="token plain"> </span><span class="token string">&quot;function&quot;</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token string">&quot;object&quot;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T0</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">TypeName</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// &quot;string&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T1</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">TypeName</span><span class="token operator">&lt;</span><span class="token string">&quot;a&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// &quot;string&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T2</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">TypeName</span><span class="token operator">&lt;</span><span class="token boolean">true</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// &quot;boolean&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T3</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">TypeName</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// &quot;function&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T4</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">TypeName</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// &quot;object&quot;</span></div></pre></div><h3 id="分布式有条件类型"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#分布式有条件类型"><span class="icon icon-link"></span></a>分布式有条件类型</h3><p>如果有条件类型里待检查的类型是<code>naked type parameter</code>，那么它也被称为“分布式有条件类型”。 分布式有条件类型在实例化时会自动分发成联合类型。 例如，实例化<code>T extends U ? X : Y</code>，<code>T</code>的类型为<code>A | B | C</code>，会被解析为<code>(A extends U ? X : Y) | (B extends U ? X : Y) | (C extends U ? X : Y)</code>。</p><h4 id="例子-1"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#例子-1"><span class="icon icon-link"></span></a>例子</h4><div class="__dumi-default-code-block"><pre class="prism-code language-typescript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T10</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">TypeName</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// &quot;string&quot; | &quot;function&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T12</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">TypeName</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token keyword nil">undefined</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// &quot;string&quot; | &quot;object&quot; | &quot;undefined&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T11</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">TypeName</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// &quot;object&quot;</span></div></pre></div><p>在<code>T extends U ? X : Y</code>的实例化里，对<code>T</code>的引用被解析为联合类型的一部分（比如，<code>T</code>指向某一单个部分，在有条件类型分布到联合类型之后）。 此外，在<code>X</code>内对<code>T</code>的引用有一个附加的类型参数约束<code>U</code>（例如，<code>T</code>被当成在<code>X</code>内可赋值给<code>U</code>）。</p><h4 id="例子-2"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#例子-2"><span class="icon icon-link"></span></a>例子</h4><div class="__dumi-default-code-block"><pre class="prism-code language-typescript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">BoxedValue</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> value</span><span class="token operator">:</span><span class="token plain"> </span><span class="token constant">T</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">BoxedArray</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> array</span><span class="token operator">:</span><span class="token plain"> </span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">Boxed</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token constant">T</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token operator">?</span><span class="token plain"> </span><span class="token maybe-class-name">BoxedArray</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token builtin">number</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"> </span><span class="token maybe-class-name">BoxedValue</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T20</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Boxed</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// BoxedValue&lt;string&gt;;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T21</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Boxed</span><span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// BoxedArray&lt;number&gt;;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T22</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Boxed</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// BoxedValue&lt;string&gt; | BoxedArray&lt;number&gt;;</span></div></pre></div><p>注意在<code>Boxed&lt;T&gt;</code>的<code>true</code>分支里，<code>T</code>有个额外的约束<code>any[]</code>，因此它适用于<code>T[number]</code>数组元素类型。同时也注意一下有条件类型是如何分布成联合类型的。</p><p>有条件类型的分布式的属性可以方便地用来_过滤_联合类型：</p><div class="__dumi-default-code-block"><pre class="prism-code language-typescript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">Diff</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name punctuation">,</span><span class="token class-name"> </span><span class="token class-name constant">U</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token constant">T</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name constant">U</span><span class="token plain"> </span><span class="token operator">?</span><span class="token plain"> </span><span class="token builtin">never</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"> </span><span class="token constant">T</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// Remove types from T that are assignable to U</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">Filter</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name punctuation">,</span><span class="token class-name"> </span><span class="token class-name constant">U</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token constant">T</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name constant">U</span><span class="token plain"> </span><span class="token operator">?</span><span class="token plain"> </span><span class="token constant">T</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">never</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// Remove types from T that are not assignable to U</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T30</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Diff</span><span class="token operator">&lt;</span><span class="token string">&quot;a&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token string">&quot;b&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token string">&quot;c&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token string">&quot;d&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;a&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token string">&quot;c&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token string">&quot;f&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// &quot;b&quot; | &quot;d&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T31</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Filter</span><span class="token operator">&lt;</span><span class="token string">&quot;a&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token string">&quot;b&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token string">&quot;c&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token string">&quot;d&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;a&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token string">&quot;c&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token string">&quot;f&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// &quot;a&quot; | &quot;c&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T32</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Diff</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token known-class-name class-name">Function</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// string | number</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T33</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Filter</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token known-class-name class-name">Function</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// () =&gt; void</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">NonNullable</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Diff</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token keyword null nil">null</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token keyword nil">undefined</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// Remove null and undefined from T</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T34</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">NonNullable</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token keyword nil">undefined</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// string | number</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T35</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">NonNullable</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token keyword null nil">null</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token keyword nil">undefined</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// string | string[]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">function</span><span class="token plain"> </span><span class="token generic-function function">f1</span><span class="token generic-function generic class-name operator">&lt;</span><span class="token generic-function generic class-name constant">T</span><span class="token generic-function generic class-name operator">&gt;</span><span class="token punctuation">(</span><span class="token plain">x</span><span class="token operator">:</span><span class="token plain"> </span><span class="token constant">T</span><span class="token punctuation">,</span><span class="token plain"> y</span><span class="token operator">:</span><span class="token plain"> </span><span class="token maybe-class-name">NonNullable</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    x </span><span class="token operator">=</span><span class="token plain"> y</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// Ok</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    y </span><span class="token operator">=</span><span class="token plain"> x</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// Error</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">function</span><span class="token plain"> </span><span class="token generic-function function">f2</span><span class="token generic-function generic class-name operator">&lt;</span><span class="token generic-function generic class-name constant">T</span><span class="token generic-function generic class-name"> </span><span class="token generic-function generic class-name keyword">extends</span><span class="token generic-function generic class-name"> </span><span class="token generic-function generic class-name builtin">string</span><span class="token generic-function generic class-name"> </span><span class="token generic-function generic class-name operator">|</span><span class="token generic-function generic class-name"> </span><span class="token generic-function generic class-name keyword nil">undefined</span><span class="token generic-function generic class-name operator">&gt;</span><span class="token punctuation">(</span><span class="token plain">x</span><span class="token operator">:</span><span class="token plain"> </span><span class="token constant">T</span><span class="token punctuation">,</span><span class="token plain"> y</span><span class="token operator">:</span><span class="token plain"> </span><span class="token maybe-class-name">NonNullable</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    x </span><span class="token operator">=</span><span class="token plain"> y</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// Ok</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    y </span><span class="token operator">=</span><span class="token plain"> x</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// Error</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">let</span><span class="token plain"> s1</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> x</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// Error</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">let</span><span class="token plain"> s2</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> y</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// Ok</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span></div></pre></div><p>有条件类型与映射类型结合时特别有用：</p><div class="__dumi-default-code-block"><pre class="prism-code language-typescript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">FunctionPropertyNames</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token plain"> </span><span class="token keyword">in</span><span class="token plain"> </span><span class="token keyword">keyof</span><span class="token plain"> </span><span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span><span class="token plain"> </span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name known-class-name class-name">Function</span><span class="token plain"> </span><span class="token operator">?</span><span class="token plain"> </span><span class="token constant">K</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">never</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token keyword">keyof</span><span class="token plain"> </span><span class="token constant">T</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">FunctionProperties</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Pick</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token maybe-class-name">FunctionPropertyNames</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">NonFunctionPropertyNames</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token plain"> </span><span class="token keyword">in</span><span class="token plain"> </span><span class="token keyword">keyof</span><span class="token plain"> </span><span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span><span class="token plain"> </span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name known-class-name class-name">Function</span><span class="token plain"> </span><span class="token operator">?</span><span class="token plain"> </span><span class="token builtin">never</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"> </span><span class="token constant">K</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token keyword">keyof</span><span class="token plain"> </span><span class="token constant">T</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">NonFunctionProperties</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Pick</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token maybe-class-name">NonFunctionPropertyNames</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">interface</span><span class="token plain"> </span><span class="token class-name maybe-class-name">Part</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    id</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    subparts</span><span class="token operator">:</span><span class="token plain"> </span><span class="token maybe-class-name">Part</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">updatePart</span><span class="token punctuation">(</span><span class="token plain">newName</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token plain"> </span><span class="token keyword">void</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T40</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">FunctionPropertyNames</span><span class="token operator">&lt;</span><span class="token maybe-class-name">Part</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// &quot;updatePart&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T41</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">NonFunctionPropertyNames</span><span class="token operator">&lt;</span><span class="token maybe-class-name">Part</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// &quot;id&quot; | &quot;name&quot; | &quot;subparts&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T42</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">FunctionProperties</span><span class="token operator">&lt;</span><span class="token maybe-class-name">Part</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// { updatePart(newName: string): void }</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T43</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">NonFunctionProperties</span><span class="token operator">&lt;</span><span class="token maybe-class-name">Part</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// { id: number, name: string, subparts: Part[] }</span></div></pre></div><p>与联合类型和交叉类型相似，有条件类型不允许递归地引用自己。比如下面的错误。</p><h4 id="例子-3"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#例子-3"><span class="icon icon-link"></span></a>例子</h4><div class="__dumi-default-code-block"><pre class="prism-code language-typescript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">ElementType</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token constant">T</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token operator">?</span><span class="token plain"> </span><span class="token maybe-class-name">ElementType</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token builtin">number</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"> </span><span class="token constant">T</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// Error</span></div></pre></div><h3 id="有条件类型中的类型推断"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#有条件类型中的类型推断"><span class="icon icon-link"></span></a>有条件类型中的类型推断</h3><p>现在在有条件类型的<code>extends</code>子语句中，允许出现<code>infer</code>声明，它会引入一个待推断的类型变量。 这个推断的类型变量可以在有条件类型的true分支中被引用。 允许出现多个同类型变量的<code>infer</code>。</p><p>例如，下面代码会提取函数类型的返回值类型：</p><div class="__dumi-default-code-block"><pre class="prism-code language-typescript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">ReturnType</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token constant">T</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token spread operator">...</span><span class="token plain">args</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token keyword">infer</span><span class="token plain"> </span><span class="token constant">R</span><span class="token plain"> </span><span class="token operator">?</span><span class="token plain"> </span><span class="token constant">R</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">any</span><span class="token punctuation">;</span></div></pre></div><p>有条件类型可以嵌套来构成一系列的匹配模式，按顺序进行求值：</p><div class="__dumi-default-code-block"><pre class="prism-code language-typescript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">Unpacked</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token constant">T</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token keyword">infer</span><span class="token plain"> </span><span class="token constant">U</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token operator">?</span><span class="token plain"> </span><span class="token constant">U</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token constant">T</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token spread operator">...</span><span class="token plain">args</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token keyword">infer</span><span class="token plain"> </span><span class="token constant">U</span><span class="token plain"> </span><span class="token operator">?</span><span class="token plain"> </span><span class="token constant">U</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token constant">T</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name known-class-name class-name">Promise</span><span class="token class-name operator">&lt;</span><span class="token class-name keyword">infer</span><span class="token class-name"> </span><span class="token class-name constant">U</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">?</span><span class="token plain"> </span><span class="token constant">U</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token constant">T</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T0</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Unpacked</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// string</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T1</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Unpacked</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// string</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T2</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Unpacked</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// string</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T3</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Unpacked</span><span class="token operator">&lt;</span><span class="token known-class-name class-name">Promise</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// string</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T4</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Unpacked</span><span class="token operator">&lt;</span><span class="token known-class-name class-name">Promise</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// Promise&lt;string&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T5</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Unpacked</span><span class="token operator">&lt;</span><span class="token maybe-class-name">Unpacked</span><span class="token operator">&lt;</span><span class="token known-class-name class-name">Promise</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// string</span></div></pre></div><p>下面的例子解释了在协变位置上，同一个类型变量的多个候选类型会被推断为联合类型：</p><div class="__dumi-default-code-block"><pre class="prism-code language-typescript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">Foo</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token constant">T</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> a</span><span class="token operator">:</span><span class="token plain"> </span><span class="token keyword">infer</span><span class="token plain"> </span><span class="token constant">U</span><span class="token punctuation">,</span><span class="token plain"> b</span><span class="token operator">:</span><span class="token plain"> </span><span class="token keyword">infer</span><span class="token plain"> </span><span class="token constant">U</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">?</span><span class="token plain"> </span><span class="token constant">U</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">never</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T10</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Foo</span><span class="token operator">&lt;</span><span class="token punctuation">{</span><span class="token plain"> a</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation">,</span><span class="token plain"> b</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// string</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T11</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Foo</span><span class="token operator">&lt;</span><span class="token punctuation">{</span><span class="token plain"> a</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation">,</span><span class="token plain"> b</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// string | number</span></div></pre></div><p>相似地，在抗变位置上，同一个类型变量的多个候选类型会被推断为交叉类型：</p><div class="__dumi-default-code-block"><pre class="prism-code language-typescript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">Bar</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token constant">T</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token function-variable function">a</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">x</span><span class="token operator">:</span><span class="token plain"> </span><span class="token keyword">infer</span><span class="token plain"> </span><span class="token constant">U</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token keyword">void</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token function-variable function">b</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">x</span><span class="token operator">:</span><span class="token plain"> </span><span class="token keyword">infer</span><span class="token plain"> </span><span class="token constant">U</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token keyword">void</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">?</span><span class="token plain"> </span><span class="token constant">U</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">never</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T20</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Bar</span><span class="token operator">&lt;</span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token function-variable function">a</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">x</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token keyword">void</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token function-variable function">b</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">x</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token keyword">void</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// string</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T21</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Bar</span><span class="token operator">&lt;</span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token function-variable function">a</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">x</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token keyword">void</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token function-variable function">b</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">x</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token keyword">void</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// string &amp; number</span></div></pre></div><p>当推断具有多个调用签名（例如函数重载类型）的类型时，用_最后_的签名（大概是最自由的包含所有情况的签名）进行推断。 无法根据参数类型列表来解析重载。</p><div class="__dumi-default-code-block"><pre class="prism-code language-typescript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">declare</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token plain">x</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">declare</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token plain">x</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">declare</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token plain">x</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T30</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">ReturnType</span><span class="token operator">&lt;</span><span class="token keyword">typeof</span><span class="token plain"> foo</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// string | number</span></div></pre></div><p>无法在正常类型参数的约束子语句中使用<code>infer</code>声明：</p><div class="__dumi-default-code-block"><pre class="prism-code language-typescript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">ReturnType</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name"> </span><span class="token class-name keyword">extends</span><span class="token class-name"> </span><span class="token class-name punctuation">(</span><span class="token class-name spread operator">...</span><span class="token class-name">args</span><span class="token class-name operator">:</span><span class="token class-name"> </span><span class="token class-name builtin">any</span><span class="token class-name punctuation">[</span><span class="token class-name punctuation">]</span><span class="token class-name punctuation">)</span><span class="token class-name"> </span><span class="token class-name arrow operator">=&gt;</span><span class="token plain"> </span><span class="token keyword">infer</span><span class="token plain"> </span><span class="token constant">R</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token constant">R</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// 错误，不支持</span></div></pre></div><p>但是，可以这样达到同样的效果，在约束里删掉类型变量，用有条件类型替换：</p><div class="__dumi-default-code-block"><pre class="prism-code language-typescript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">AnyFunction</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token spread operator">...</span><span class="token plain">args</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token builtin">any</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">ReturnType</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name"> </span><span class="token class-name keyword">extends</span><span class="token class-name"> </span><span class="token class-name maybe-class-name">AnyFunction</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token constant">T</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token spread operator">...</span><span class="token plain">args</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token keyword">infer</span><span class="token plain"> </span><span class="token constant">R</span><span class="token plain"> </span><span class="token operator">?</span><span class="token plain"> </span><span class="token constant">R</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">any</span><span class="token punctuation">;</span></div></pre></div><h3 id="预定义的有条件类型"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#预定义的有条件类型"><span class="icon icon-link"></span></a>预定义的有条件类型</h3><p>TypeScript 2.8在<code>lib.d.ts</code>里增加了一些预定义的有条件类型：</p><ul><li><code>Exclude&lt;T, U&gt;</code> -- 从<code>T</code>中剔除可以赋值给<code>U</code>的类型。</li><li><code>Extract&lt;T, U&gt;</code> -- 提取<code>T</code>中可以赋值给<code>U</code>的类型。</li><li><code>NonNullable&lt;T&gt;</code> -- 从<code>T</code>中剔除<code>null</code>和<code>undefined</code>。</li><li><code>ReturnType&lt;T&gt;</code> -- 获取函数返回值类型。</li><li><code>InstanceType&lt;T&gt;</code> -- 获取构造函数类型的实例类型。</li></ul><h4 id="example"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#example"><span class="icon icon-link"></span></a>Example</h4><div class="__dumi-default-code-block"><pre class="prism-code language-typescript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T00</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Exclude</span><span class="token operator">&lt;</span><span class="token string">&quot;a&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token string">&quot;b&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token string">&quot;c&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token string">&quot;d&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;a&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token string">&quot;c&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token string">&quot;f&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// &quot;b&quot; | &quot;d&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T01</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Extract</span><span class="token operator">&lt;</span><span class="token string">&quot;a&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token string">&quot;b&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token string">&quot;c&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token string">&quot;d&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;a&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token string">&quot;c&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token string">&quot;f&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// &quot;a&quot; | &quot;c&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T02</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Exclude</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token known-class-name class-name">Function</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// string | number</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T03</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Extract</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token known-class-name class-name">Function</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// () =&gt; void</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T04</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">NonNullable</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token keyword nil">undefined</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// string | number</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T05</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">NonNullable</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token keyword null nil">null</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token keyword nil">undefined</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// (() =&gt; string) | string[]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">f1</span><span class="token punctuation">(</span><span class="token plain">s</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword control-flow">return</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> a</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">,</span><span class="token plain"> b</span><span class="token operator">:</span><span class="token plain"> s </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name constant">C</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    x </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    y </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T10</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">ReturnType</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// string</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T11</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">ReturnType</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token plain">s</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// void</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T12</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">ReturnType</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// {}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T13</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">ReturnType</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name constant">U</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token constant">U</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// number[]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T14</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">ReturnType</span><span class="token operator">&lt;</span><span class="token keyword">typeof</span><span class="token plain"> f1</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// { a: number, b: string }</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T15</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">ReturnType</span><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// any</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T16</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">ReturnType</span><span class="token operator">&lt;</span><span class="token builtin">never</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// any</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T17</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">ReturnType</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// Error</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T18</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">ReturnType</span><span class="token operator">&lt;</span><span class="token known-class-name class-name">Function</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// Error</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T20</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">InstanceType</span><span class="token operator">&lt;</span><span class="token keyword">typeof</span><span class="token plain"> </span><span class="token constant">C</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// C</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T21</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">InstanceType</span><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// any</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T22</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">InstanceType</span><span class="token operator">&lt;</span><span class="token builtin">never</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// any</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T23</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">InstanceType</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// Error</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T24</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">InstanceType</span><span class="token operator">&lt;</span><span class="token known-class-name class-name">Function</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// Error</span></div></pre></div><blockquote><p>注意：<code>Exclude</code>类型是<a target="_blank" rel="noopener noreferrer" href="https://github.com/Microsoft/TypeScript/issues/12215#issuecomment-307871458">建议的<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><code>Diff</code>类型的一种实现。我们使用<code>Exclude</code>这个名字是为了避免破坏已经定义了<code>Diff</code>的代码，并且我们感觉这个名字能更好地表达类型的语义。我们没有增加<code>Omit&lt;T, K&gt;</code>类型，因为它可以很容易的用<code>Pick&lt;T, Exclude&lt;keyof T, K&gt;&gt;</code>来表示。</p></blockquote><h2 id="改进对映射类型修饰符的控制"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#改进对映射类型修饰符的控制"><span class="icon icon-link"></span></a>改进对映射类型修饰符的控制</h2><p>映射类型支持在属性上添加<code>readonly</code>或<code>?</code>修饰符，但是它们不支持_移除_修饰符。 这对于<a target="_blank" rel="noopener noreferrer" href="https://github.com/Microsoft/TypeScript/pull/12563"><em>同态映射类型</em></a>有些影响，因为同态映射类型默认保留底层类型的修饰符。</p><p>TypeScript 2.8为映射类型增加了增加或移除特定修饰符的能力。 特别地，映射类型里的<code>readonly</code>或<code>?</code>属性修饰符现在可以使用<code>+</code>或<code>-</code>前缀，来表示修饰符是添加还是移除。</p><h4 id="例子-4"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#例子-4"><span class="icon icon-link"></span></a>例子</h4><div class="__dumi-default-code-block"><pre class="prism-code language-typescript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">MutableRequired</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token operator">-</span><span class="token keyword">readonly</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token plain"> </span><span class="token keyword">in</span><span class="token plain"> </span><span class="token keyword">keyof</span><span class="token plain"> </span><span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">?</span><span class="token operator">:</span><span class="token plain"> </span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// 移除readonly和?</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">ReadonlyPartial</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token operator">+</span><span class="token keyword">readonly</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token plain"> </span><span class="token keyword">in</span><span class="token plain"> </span><span class="token keyword">keyof</span><span class="token plain"> </span><span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token operator">?</span><span class="token operator">:</span><span class="token plain"> </span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// 添加readonly和?</span></div></pre></div><p>不带<code>+</code>或<code>-</code>前缀的修饰符与带<code>+</code>前缀的修饰符具有相同的作用。因此上面的<code>ReadonlyPartial&lt;T&gt;</code>类型与下面的一致</p><div class="__dumi-default-code-block"><pre class="prism-code language-typescript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">ReadonlyPartial</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token keyword">readonly</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token plain"> </span><span class="token keyword">in</span><span class="token plain"> </span><span class="token keyword">keyof</span><span class="token plain"> </span><span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">:</span><span class="token plain"> </span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// 添加readonly和?</span></div></pre></div><p>利用这个特性，<code>lib.d.ts</code>现在有了一个新的<code>Required&lt;T&gt;</code>类型。 它移除了<code>T</code>的所有属性的<code>?</code>修饰符，因此所有属性都是必需的。</p><h4 id="例子-5"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#例子-5"><span class="icon icon-link"></span></a>例子</h4><div class="__dumi-default-code-block"><pre class="prism-code language-typescript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">Required</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token plain"> </span><span class="token keyword">in</span><span class="token plain"> </span><span class="token keyword">keyof</span><span class="token plain"> </span><span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">?</span><span class="token operator">:</span><span class="token plain"> </span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><p>注意在<code>--strictNullChecks</code>模式下，当同态映射类型移除了属性底层类型的<code>?</code>修饰符，它同时也移除了那个属性上的<code>undefined</code>类型：</p><h4 id="例子-6"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#例子-6"><span class="icon icon-link"></span></a>例子</h4><div class="__dumi-default-code-block"><pre class="prism-code language-typescript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">Foo</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> a</span><span class="token operator">?</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// 等同于 { a?: string | undefined }</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">Bar</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">Required</span><span class="token operator">&lt;</span><span class="token maybe-class-name">Foo</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// 等同于 { a: string }</span></div></pre></div><h2 id="改进交叉类型上的keyof"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#改进交叉类型上的keyof"><span class="icon icon-link"></span></a>改进交叉类型上的<code>keyof</code></h2><p>TypeScript 2.8作用于交叉类型的<code>keyof</code>被转换成作用于交叉成员的<code>keyof</code>的联合。 换句话说，<code>keyof (A &amp; B)</code>会被转换成<code>keyof A | keyof B</code>。 这个改动应该能够解决<code>keyof</code>表达式推断不一致的问题。</p><h4 id="例子-7"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#例子-7"><span class="icon icon-link"></span></a>例子</h4><div class="__dumi-default-code-block"><pre class="prism-code language-typescript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">A</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> a</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">B</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> b</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T1</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">keyof</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token constant">A</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain"> </span><span class="token constant">B</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// &quot;a&quot; | &quot;b&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T2</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">keyof</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token constant">T</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain"> </span><span class="token constant">B</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// keyof T | &quot;b&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T3</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">U</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">keyof</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token constant">A</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain"> </span><span class="token constant">U</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// &quot;a&quot; | keyof U</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T4</span><span class="token class-name operator">&lt;</span><span class="token class-name constant">T</span><span class="token class-name punctuation">,</span><span class="token class-name"> </span><span class="token class-name constant">U</span><span class="token class-name operator">&gt;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">keyof</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token constant">T</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain"> </span><span class="token constant">U</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// keyof T | keyof U</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T5</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token constant">T2</span><span class="token operator">&lt;</span><span class="token constant">A</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// &quot;a&quot; | &quot;b&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T6</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token constant">T3</span><span class="token operator">&lt;</span><span class="token constant">B</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// &quot;a&quot; | &quot;b&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">type</span><span class="token plain"> </span><span class="token class-name constant">T7</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token constant">T4</span><span class="token operator">&lt;</span><span class="token constant">A</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token constant">B</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain">  </span><span class="token comment">// &quot;a&quot; | &quot;b&quot;</span></div></pre></div><h2 id="更好的处理js文件中的命名空间模式"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#更好的处理js文件中的命名空间模式"><span class="icon icon-link"></span></a>更好的处理<code>.js</code>文件中的命名空间模式</h2><p>TypeScript 2.8加强了识别<code>.js</code>文件里的命名空间模式。 JavaScript顶层的空对象字面量声明，就像函数和类，会被识别成命名空间声明。</p><div class="__dumi-default-code-block"><pre class="prism-code language-javascript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">var</span><span class="token plain"> ns </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain">     </span><span class="token comment">// recognized as a declaration for a namespace `ns`</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">ns</span><span class="token punctuation">.</span><span class="token property-access">constant</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment">// recognized as a declaration for var `constant`</span></div></pre></div><p>顶层的赋值应该有一致的行为；也就是说，<code>var</code>或<code>const</code>声明不是必需的。</p><div class="__dumi-default-code-block"><pre class="prism-code language-javascript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">app </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment">// does NOT need to be `var app = {}`</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">app</span><span class="token punctuation">.</span><span class="token constant">C</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">class</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">app</span><span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">f</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">app</span><span class="token punctuation">.</span><span class="token property-access">prop</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">;</span></div></pre></div><h3 id="立即执行的函数表达式做为命名空间"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#立即执行的函数表达式做为命名空间"><span class="icon icon-link"></span></a>立即执行的函数表达式做为命名空间</h3><p>立即执行的函数表达式返回一个函数，类或空的对象字面量，也会被识别为命名空间：</p><div class="__dumi-default-code-block"><pre class="prism-code language-javascript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">var</span><span class="token plain"> </span><span class="token constant">C</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token constant">C</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">p</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> n</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword control-flow">return</span><span class="token plain"> </span><span class="token constant">C</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token constant">C</span><span class="token punctuation">.</span><span class="token property-access">staticProperty</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">;</span></div></pre></div><h3 id="默认声明"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#默认声明"><span class="icon icon-link"></span></a>默认声明</h3><p>“默认声明”允许引用了声明的名称的初始化器出现在逻辑或的左边：</p><div class="__dumi-default-code-block"><pre class="prism-code language-javascript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">my </span><span class="token operator">=</span><span class="token plain"> </span><span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">my</span><span class="token plain"> </span><span class="token operator">||</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">my</span><span class="token punctuation">.</span><span class="token property-access">app</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> my</span><span class="token punctuation">.</span><span class="token property-access">app</span><span class="token plain"> </span><span class="token operator">||</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><h3 id="原型赋值"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#原型赋值"><span class="icon icon-link"></span></a>原型赋值</h3><p>你可以把一个对象字面量直接赋值给原型属性。独立的原型赋值也可以：</p><div class="__dumi-default-code-block"><pre class="prism-code language-typescript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">var</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name">C</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">p</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">p</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> p</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token constant">C</span><span class="token punctuation">.</span><span class="token property-access">prototype</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">p</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token constant">C</span><span class="token punctuation">.</span><span class="token property-access">prototype</span><span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">q</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token plain">r</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword control-flow">return</span><span class="token plain"> </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">p</span><span class="token plain"> </span><span class="token operator">===</span><span class="token plain"> r</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><h3 id="嵌套与合并声明"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#嵌套与合并声明"><span class="icon icon-link"></span></a>嵌套与合并声明</h3><p>现在嵌套的层次不受限制，并且多文件之间的声明合并也没有问题。以前不是这样的。</p><div class="__dumi-default-code-block"><pre class="prism-code language-javascript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">var</span><span class="token plain"> app </span><span class="token operator">=</span><span class="token plain"> </span><span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">app</span><span class="token plain"> </span><span class="token operator">||</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">app</span><span class="token punctuation">.</span><span class="token constant">C</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">class</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><h2 id="各文件的jsx工厂"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#各文件的jsx工厂"><span class="icon icon-link"></span></a>各文件的JSX工厂</h2><p>TypeScript 2.8增加了使用<code>@jsx dom</code>指令为每个文件设置JSX工厂名。 JSX工厂也可以使用<code>--jsxFactory</code>编译参数设置（默认值为<code>React.createElement</code>）。TypeScript 2.8你可以基于文件进行覆写。</p><h4 id="例子-8"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#例子-8"><span class="icon icon-link"></span></a>例子</h4><div class="__dumi-default-code-block"><pre class="prism-code language-typescript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">/** @jsx dom */</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">import</span><span class="token plain"> </span><span class="token imports punctuation">{</span><span class="token imports"> dom </span><span class="token imports punctuation">}</span><span class="token plain"> </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&quot;./renderer&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator">&lt;</span><span class="token plain">h</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token plain">h</span><span class="token operator">&gt;</span></div></pre></div><p>生成：</p><div class="__dumi-default-code-block"><pre class="prism-code language-javascript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">var</span><span class="token plain"> renderer_1 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./renderer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">renderer_1</span><span class="token punctuation">.</span><span class="token method function property-access">dom</span><span class="token punctuation">(</span><span class="token string">&quot;h&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre></div><h2 id="本地范围的jsx命名空间"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#本地范围的jsx命名空间"><span class="icon icon-link"></span></a>本地范围的JSX命名空间</h2><p>JSX类型检查基于JSX命名空间里的定义，比如<code>JSX.Element</code>用于JSX元素的类型，<code>JSX.IntrinsicElements</code>用于内置的元素。 在TypeScript 2.8之前<code>JSX</code>命名空间被视为全局命名空间，并且一个工程只允许存在一个。 TypeScript 2.8开始，<code>JSX</code>命名空间将在<code>jsxNamespace</code>下面查找（比如<code>React</code>），允许在一次编译中存在多个jsx工厂。 为了向后兼容，全局的<code>JSX</code>命名空间被当做回退选项。 使用独立的<code>@jsx</code>指令，每个文件可以有自己的JSX工厂。</p><h2 id="新的--emitdeclarationsonly"><a aria-hidden="true" tabindex="-1" href="/typescript//release-notes/typescript-2_8#新的--emitdeclarationsonly"><span class="icon icon-link"></span></a>新的<code>--emitDeclarationsOnly</code></h2><p><code>--emitDeclarationsOnly</code>允许_仅_生成声明文件；使用这个标记<code>.js</code>/<code>.jsx</code>输出会被跳过。当使用其它的转换工具如Babel处理<code>.js</code>输出的时候，可以使用这个标记。</p></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/onlyxhb/typescript/edit/master/zh/release-notes/typescript-2_8.md">在 GitHub 上编辑此页<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="最后更新时间：">2/23/2022 18:39:43</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/typescript/umi.07b86845.js"></script>
  </body>
</html>
